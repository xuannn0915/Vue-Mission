import{M,P as x}from"./PaginationComponent-cQEyeoOd.js";import{_ as v,o as i,c,a as t,t as n,e as k,v as V,F as p,f,g,d as _,r as h,b as m,n as w}from"./index-lCZ1nyxc.js";const $={data(){return{modal:null,qty:1}},props:["modalContent","addToCart","status"],methods:{openModal(){this.modal.show()},closeModal(){this.modal.hide()}},watch:{modalContent(){this.qty=1}},mounted(){this.modal=new M(this.$refs.modal)}},T={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-hidden":"true",ref:"modal"},E={class:"modal-dialog modal-xl",role:"document"},I={class:"modal-content border-0"},D={class:"modal-header bg-light text-white"},S={class:"modal-title text-dark",id:"exampleModalLabel"},U=t("button",{type:"button",class:"btn-close text-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),q={class:"modal-body"},R={class:"row"},z={class:"col-sm-6"},B=["src"],N={class:"col-sm-6"},A={class:"badge bg-primary rounded-pill"},F={class:"h5"},H={class:"h6"},O={class:"h5"},j={class:"input-group"},G=["value"],J=["disabled"],K={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function Q(d,o,e,r,a,u){return i(),c("div",T,[t("div",E,[t("div",I,[t("div",D,[t("h5",S,[t("span",null,n(e.modalContent.title),1)]),U]),t("div",q,[t("div",R,[t("div",z,[t("img",{class:"img-fluid",src:e.modalContent.imageUrl,alt:""},null,8,B)]),t("div",N,[t("span",A,n(e.modalContent.category),1),t("p",null,"商品描述："+n(e.modalContent.description),1),t("p",null,"商品內容："+n(e.modalContent.content),1),t("div",F,n(e.modalContent.price)+"元",1),t("del",H,"原價"+n(e.modalContent.origin_price)+" 元",1),t("div",O,"現在只要"+n(e.modalContent.price)+" 元",1),t("div",null,[t("div",j,[k(t("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":o[0]||(o[0]=l=>a.qty=l)},[(i(),c(p,null,f(20,l=>t("option",{value:l,key:l},n(l),9,G)),64))],512),[[V,a.qty]]),t("button",{type:"button",class:"btn btn-primary",onClick:o[1]||(o[1]=l=>e.addToCart(e.modalContent.id,a.qty)),disabled:e.status===e.modalContent.id},[e.status===e.modalContent.id?(i(),c("span",K)):g("",!0),_(" 加入購物車 ")],8,J)])])])])])])])],512)}const W=v($,[["render",Q]]);var X={VITE_PATH:"xuan02",VITE_URL:"https://vue3-course-api.hexschool.io",BASE_URL:"/Vue-Mission/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:b,VITE_PATH:C}=X,Y={data(){return{productList:[],tempProduct:{},pagesInfo:{},status:{isLoading:!0,addCartLoading:!0}}},methods:{showProductModal(d){this.tempProduct=d,this.$refs.productModal.openModal()},addProduct(d,o=1){const e={product_id:d,qty:o};this.status.addCartLoading=d,this.$http.post(`${b}/v2/api/${C}/cart`,{data:e}).then(r=>{this.status.addCartLoading="",alert(r.data.message),this.$refs.productModal.closeModal()}).catch(r=>{console.log(r.response)})},renderProductList(d){this.$http.get(`${b}/v2/api/${C}/products?page=${d}`).then(o=>{this.productList=o.data.products,this.status.isLoading=!1,this.pagesInfo=o.data.pagination}).catch(o=>{console.log(o.response)})}},components:{productModal:W,PaginationComponent:x},mounted(){this.renderProductList(1)}},Z={class:"p-4"},tt=t("h2",null,"這是產品列表頁",-1),et={class:"table align-middle"},ot=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),st={style:{"inline-size":"200px"}},nt={key:0,class:"h5"},at={class:"h6 text-secondary"},dt={class:"h5"},lt={class:"text-danger"},it={class:"btn-group btn-group-sm"},ct=["onClick"],rt=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),ut=["onClick","disabled"],_t={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function ht(d,o,e,r,a,u){const l=h("LoadingComponent"),y=h("PaginationComponent"),L=h("productModal");return i(),c(p,null,[t("main",Z,[tt,m(l,{active:a.status.isLoading},null,8,["active"]),t("table",et,[ot,t("tbody",null,[(i(!0),c(p,null,f(a.productList,s=>(i(),c("tr",{key:s.id},[t("td",st,[t("div",{style:w([{"block-size":"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${s.imageUrl})`}])},null,4)]),t("td",null,n(s.title),1),t("td",null,[s.origin_price===s.price?(i(),c("div",nt,n(s.price)+" 元 ",1)):g("",!0),t("div",null,[t("del",at,"原價 "+n(s.origin_price)+" 元",1),t("div",dt,[_(" 現在只要 "),t("span",lt,n(s.price),1),_(" 元 ")])])]),t("td",null,[t("div",it,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:P=>u.showProductModal(s)},[rt,_(" 查看更多 ")],8,ct),t("button",{type:"button",class:"btn btn-outline-danger",onClick:P=>u.addProduct(s.id),disabled:a.status.addCartLoading===s.id},[a.status.addCartLoading===s.id?(i(),c("span",_t)):g("",!0),_(" 加到購物車 ")],8,ut)])])]))),128))])]),m(y,{pages:a.pagesInfo,onChoosePage:u.renderProductList},null,8,["pages","onChoosePage"])]),m(L,{"modal-content":a.tempProduct,ref:"productModal","add-to-cart":u.addProduct,status:a.status.addCartLoading},null,8,["modal-content","add-to-cart","status"])],64)}const gt=v(Y,[["render",ht]]);export{gt as default};
