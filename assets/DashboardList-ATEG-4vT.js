import{M as w,P as k}from"./PaginationComponent-cQEyeoOd.js";import{_ as M,o as d,c as a,a as e,e as r,i as c,F as v,f as P,l as C,d as T,t as p,r as m,b,h as V}from"./index-lCZ1nyxc.js";const $={props:["tempProduct","saveProduct","isNew"],data(){return{productModal:null,dashboardTemp:{}}},methods:{openModal(){this.productModal.show()},closeModal(){this.productModal.hide()}},watch:{tempProduct(){this.dashboardTemp=this.tempProduct}},mounted(){this.productModal=new w(this.$refs.productModal),this.dashboardTemp=this.tempProduct}},D={class:"modal fade",tabindex:"-1",id:"addModal","data-bs-backdrop":"static",ref:"productModal"},I={class:"modal-dialog modal-xl"},L={class:"modal-content"},N={class:"modal-header bg-dark"},E={key:0,class:"modal-title text-white h4 fw-bold"},B={key:1,class:"modal-title text-white h4 fw-bold"},R={class:"modal-body"},S={class:"row"},A={class:"col-md-4"},F={class:"mb-3"},H=e("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),O=["src"],j=e("div",{class:"h5 fw-bold mb-3"},"多圖新增",-1),z={key:0},q=["for"],G=["id","onUpdate:modelValue"],J=["src"],K={class:"col-md-8"},Q={class:"mb-3"},W=e("label",{for:"title",class:"form-label"},"標題",-1),X={class:"row"},Y={class:"col-6"},Z={class:"mb-3"},ee=e("label",{for:"category",class:"form-label"},"分類",-1),oe={class:"col-6"},te={class:"mb-3"},se=e("label",{for:"unit",class:"form-label"},"單位",-1),le={class:"row"},de={class:"col-6"},ae={class:"mb-3"},ne=e("label",{for:"origin_price",class:"form-label"},"原價",-1),ie={class:"col-6"},re={class:"mb-3"},ce=e("label",{for:"price",class:"form-label"},"售價",-1),pe=e("hr",null,null,-1),he={class:"mb-3"},ue=e("label",{for:"description",class:"form-label"},"產品描述",-1),me={class:"mb-3"},be=e("label",{for:"content",class:"form-label"},"說明內容",-1),_e={class:"mb-3"},fe={class:"form-check"},ge=e("label",{class:"form-check-label align-top",for:"is_enabled"}," 是否啟用 ",-1),ve={class:"modal-footer"},Me=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ye(l,o,u,y,t,n){return d(),a("div",D,[e("div",I,[e("div",L,[e("div",N,[u.isNew?(d(),a("h5",E,"新增產品")):(d(),a("h5",B,"編輯產品"))]),e("div",R,[e("div",S,[e("div",A,[e("div",F,[H,r(e("input",{type:"text",class:"form-control",id:"imageUrl",placeholder:"請輸入圖片連結","onUpdate:modelValue":o[0]||(o[0]=s=>t.dashboardTemp.imageUrl=s)},null,512),[[c,t.dashboardTemp.imageUrl]]),e("img",{src:t.dashboardTemp.imageUrl},null,8,O)]),j,t.dashboardTemp.imagesUrl?(d(),a("div",z,[(d(!0),a(v,null,P(t.dashboardTemp.imagesUrl,(s,h)=>(d(),a("div",{class:"mb-3",key:s},[e("label",{for:h,class:"form-label"},"圖片網址",8,q),r(e("input",{type:"text",class:"form-control",id:h,placeholder:"請輸入圖片連結","onUpdate:modelValue":g=>t.dashboardTemp.imagesUrl[h]=g},null,8,G),[[c,t.dashboardTemp.imagesUrl[h]]]),e("img",{src:s},null,8,J)]))),128)),!t.dashboardTemp.imagesUrl.length||t.dashboardTemp.imagesUrl[t.dashboardTemp.imagesUrl.length-1]?(d(),a("button",{key:0,class:"btn btn-outline-primary w-100",type:"button",onClick:o[1]||(o[1]=s=>t.dashboardTemp.imagesUrl.push(""))}," 新增圖片 ")):(d(),a("button",{key:1,class:"btn btn-outline-danger w-100",type:"button",onClick:o[2]||(o[2]=s=>t.dashboardTemp.imagesUrl.pop())}," 刪除圖片 "))])):(d(),a("button",{key:1,class:"btn btn-outline-primary w-100",type:"button",onClick:o[3]||(o[3]=(...s)=>l.createImages&&l.createImages(...s))}," 新增圖片 "))]),e("div",K,[e("div",Q,[W,r(e("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":o[4]||(o[4]=s=>t.dashboardTemp.title=s)},null,512),[[c,t.dashboardTemp.title]])]),e("div",X,[e("div",Y,[e("div",Z,[ee,r(e("input",{type:"text",class:"form-control",id:"category",placeholder:"請輸入分類","onUpdate:modelValue":o[5]||(o[5]=s=>t.dashboardTemp.category=s)},null,512),[[c,t.dashboardTemp.category]])])]),e("div",oe,[e("div",te,[se,r(e("input",{type:"text",class:"form-control",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":o[6]||(o[6]=s=>t.dashboardTemp.unit=s)},null,512),[[c,t.dashboardTemp.unit]])])])]),e("div",le,[e("div",de,[e("div",ae,[ne,r(e("input",{type:"number",class:"form-control",id:"origin_price",placeholder:"請輸入原價","onUpdate:modelValue":o[7]||(o[7]=s=>t.dashboardTemp.origin_price=s)},null,512),[[c,t.dashboardTemp.origin_price,void 0,{number:!0}]])])]),e("div",ie,[e("div",re,[ce,r(e("input",{type:"number",class:"form-control",id:"price",placeholder:"請輸入售價","onUpdate:modelValue":o[8]||(o[8]=s=>t.dashboardTemp.price=s)},null,512),[[c,t.dashboardTemp.price,void 0,{number:!0}]])])])]),pe,e("div",he,[ue,r(e("textarea",{class:"form-control",id:"description",rows:"2",placeholder:"請輸入產品描述","onUpdate:modelValue":o[9]||(o[9]=s=>t.dashboardTemp.description=s)},null,512),[[c,t.dashboardTemp.description]])]),e("div",me,[be,r(e("textarea",{class:"form-control",id:"content",rows:"2",placeholder:"請輸入說明內容","onUpdate:modelValue":o[10]||(o[10]=s=>t.dashboardTemp.content=s)},null,512),[[c,t.dashboardTemp.content]])]),e("div",_e,[e("div",fe,[r(e("input",{class:"form-check-input align-middle",type:"checkbox",id:"is_enabled","onUpdate:modelValue":o[11]||(o[11]=s=>t.dashboardTemp.is_enabled=s),"true-value":1,"false-value":0},null,512),[[C,t.dashboardTemp.is_enabled]]),ge])])])])]),e("div",ve,[Me,e("button",{type:"button",class:"btn btn-primary",onClick:o[12]||(o[12]=s=>u.saveProduct(t.dashboardTemp.id))}," 確認 ")])])])],512)}const Te=M($,[["render",ye]]),we={props:["delProduct"],data(){return{deleteModal:null}},methods:{openModal(){this.deleteModal.show()},closeModal(){this.deleteModal.hide()},delItem(){this.$emit("del",this.delProduct.id)}},mounted(){this.deleteModal=new w(this.$refs.deleteModal)}},Pe={class:"modal fade",tabindex:"-1",id:"deleteModal","data-bs-backdrop":"static",ref:"deleteModal"},Ue={class:"modal-dialog"},xe={class:"modal-content"},ke=e("div",{class:"modal-header bg-danger text-white fw-bold h5"},[e("h5",{class:"modal-title"},"刪除產品")],-1),Ce={class:"modal-body"},Ve={class:"text-danger"},$e={class:"modal-footer"},De=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ie(l,o,u,y,t,n){return d(),a("div",Pe,[e("div",Ue,[e("div",xe,[ke,e("div",Ce,[e("p",null,[T(" 是否刪除 "),e("strong",Ve,p(u.delProduct.title),1),T(" 商品(刪除後將無法恢復)。 ")])]),e("div",$e,[De,e("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=(...s)=>n.delItem&&n.delItem(...s))},"確認刪除")])])])],512)}const Le=M(we,[["render",Ie]]);var Ne={VITE_PATH:"xuan02",VITE_URL:"https://vue3-course-api.hexschool.io",BASE_URL:"/Vue-Mission/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:_,VITE_PATH:f}=Ne,Ee={data(){return{products:[],isNew:!1,pagesInfo:{},tempProduct:{imagesUrl:[]},status:{isLoading:!0}}},methods:{renderProducts(l=1){this.$http.get(`${_}/v2/api/${f}/admin/products?page=${l}`).then(o=>{this.products=o.data.products,this.pagesInfo=o.data.pagination,this.status.isLoading=!1}).catch(o=>{console.log(o.response.data.message)})},openModal(l,o){l==="new"?(this.tempProduct={imagesUrl:[]},this.isNew=!0,this.$refs.dashboardModal.openModal()):l==="edit"?(this.tempProduct={...o},this.isNew=!1,this.$refs.dashboardModal.openModal()):l==="delete"&&(this.tempProduct={...o},this.$refs.deleteModal.openModal())},saveProduct(l){this.isNew===!0?this.$http.post(`${_}/v2/api/${f}/admin/product`,{data:this.tempProduct}).then(o=>{alert(o.data.message),this.renderProducts(),this.$refs.dashboardModal.closeModal()}).catch(o=>{alert(o.response.data.message)}):this.isNew===!1&&this.$http.put(`${_}/v2/api/${f}/admin/product/${l}`,{data:this.tempProduct}).then(o=>{alert(o.data.message),this.$refs.dashboardModal.closeModal(),this.renderProducts()}).catch(o=>{console.log(o.response)})},delProduct(l){this.$http.delete(`${_}/v2/api/${f}/admin/product/${l}`).then(o=>{alert(o.data.message),this.$refs.deleteModal.closeModal(),this.renderProducts()}).catch(o=>{console.log(o.response)})},createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")}},components:{PaginationComponent:k,DashboardModal:Te,DeleteModal:Le},mounted(){this.renderProducts()}},Be={class:"container"},Re={class:"productList pt-4 pb-4"},Se={class:"d-flex justify-content-end mb-5"},Ae={class:"table"},Fe=e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"fw-bold"},"分類"),e("th",{scope:"col",class:"fw-bold"},"產品名稱"),e("th",{scope:"col",class:"fw-bold"},"原價"),e("th",{scope:"col",class:"fw-bold"},"售價"),e("th",{scope:"col",class:"fw-bold"},"是否啟用"),e("th",{scope:"col",class:"fw-bold"},"編輯")])],-1),He={class:"btn-group",role:"group","aria-label":"Basic example"},Oe=["onClick"],je=["onClick"];function ze(l,o,u,y,t,n){const s=m("LoadingComponent"),h=m("PaginationComponent"),g=m("DashboardModal"),U=m("DeleteModal");return d(),a(v,null,[b(s,{active:t.status.isLoading},null,8,["active"]),e("div",Be,[e("div",Re,[e("div",Se,[e("button",{type:"button",class:"btn btn-primary",onClick:o[0]||(o[0]=i=>n.openModal("new"))}," 建立新的產品 ")]),e("table",Ae,[Fe,e("tbody",null,[(d(!0),a(v,null,P(t.products,i=>(d(),a("tr",{key:i.id},[e("td",null,p(i.category),1),e("td",null,p(i.title),1),e("td",null,p(i.origin_price),1),e("td",null,p(i.price),1),e("td",{class:V(i.is_enabled?"text-success":"text-danger")},p(i.is_enabled?"啟用":"停用"),3),e("td",null,[e("div",He,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:x=>n.openModal("edit",i)}," 編輯 ",8,Oe),e("button",{type:"button",class:"btn btn-outline-danger",onClick:x=>n.openModal("delete",i)}," 刪除 ",8,je)])])]))),128))])]),e("p",null,"目前有"+p(t.products.length)+"項產品",1),b(h,{pages:t.pagesInfo,onChoosePage:n.renderProducts},null,8,["pages","onChoosePage"])])]),b(g,{ref:"dashboardModal","temp-product":t.tempProduct,"save-product":n.saveProduct,"is-new":t.isNew},null,8,["temp-product","save-product","is-new"]),b(U,{"del-product":t.tempProduct,onDel:n.delProduct,ref:"deleteModal"},null,8,["del-product","onDel"])],64)}const Je=M(Ee,[["render",ze]]);export{Je as default};
